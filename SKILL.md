---
name: bosszhibin-auto-recruiter
description: Boss直聘自动招聘技能（带缓存）：智能存储职位配置，避免重复解析，支持增量更新。自动读取职位、解析要求、筛选候选人并打招呼，生成详细报告与自动复盘。v7.3 合并执行协议、评分规则、缓存结构与风控机制为单文件，模板按需查阅。
---

# Boss直聘自动招聘技能（v7.3）

版本：7.3-consolidated | 更新日期：2026-02-11

## 设计原则

- **Skill 层**：运行时执行协议、风控行为、评分规则——全部在本文件
- **Cache 层**：职位筛选偏好存缓存，采用"全局默认 + 职位覆盖"，Skill 不写死职位偏好
- **模板文件**：报告/指标/进化历史的数据结构定义放 `references/`，生成时按需 view

---

## 一、运行时执行协议

以下 8 条协议在整个执行过程中始终生效：

### 1. 每日上限硬终止
触发 `今日主动沟通数已达上限，需付费购买` 后**立即**停止一切点击/滚动/切职位操作，直接跳到阶段3生成总结。

### 2. 频率告警软退避
触发 `开聊太频繁` 或 `操作太频繁` 时降频重试（等待 10-30 秒），记录退避次数，**不中断任务**。

### 3. 单职位完成信号
仅在以下条件满足时切换下一个职位：
- 页面出现"没有更多" / "暂无更多" / "已加载全部" / "没有新的候选人"
- 或连续 3 次滚动页面高度不再变化

**禁止**用"出现重复候选人"作为终止条件。BOSS直聘不会循环显示候选人。

### 4. 流程模式开关
- `main_only`（默认）：仅处理主页面（推荐/精选/最新主列表）
- `full`：主页面完成后继续处理扩展页面（如新牛人等）

### 5. 点击幂等保护
同一候选人同轮最多一次点击。点击后校验按钮状态是否变为"继续沟通"，状态异常则记录日志并跳过。

### 6. 打招呼留痕
每次联系动作记录：候选人指纹（姓名+学校+公司组合键）、动作时间、命中规则标签、触发摘要（学校/技能/公司/经验各维度 pass/fail）。

### 7. 解析质量告警
姓名或关键字段提取失败占比超 20% 时，标记该批次"可信度下降"并在总结中显式提示。

### 8. 人工中断协议
收到用户"停下"后在 1 个动作周期内停止，输出进度快照：当前职位、已完成页签、终止信号状态。

---

## 二、缓存结构与规则分层

### 缓存文件位置
- 主缓存：`/home/claude/bosszhibin_cache/bosszhibin_jobs_cache.json`
- 进化历史：`/home/claude/bosszhibin_cache/evolution_history.json`

### v7.3 缓存核心结构

```json
{
  "schema_version": "7.3",
  "global_rule_defaults": {
    "experience_policy": {
      "required_range": [1, 5],
      "campus_exception_enabled": true
    },
    "ai_skill_policy": {
      "ai_skill_required": true,
      "keyword_source": "job_parse_and_user_confirm",
      "match_mode": "any"
    },
    "school_policy": {
      "bachelor_only": true,
      "required_tiers": ["985", "QS100"]
    },
    "year_parse_policy": {
      "exclude_campus_year_as_experience": true,
      "trusted_patterns": ["X年工作经验", "工作起止时间推算"]
    }
  },
  "jobs": [
    {
      "job_id": "job_001",
      "job_name": "AI算法工程师",
      "priority": "high",
      "rule_overrides": {
        "ai_skill_policy": {
          "keywords": ["LLM", "RAG", "Agent"]
        }
      },
      "stats": { "total_contacted": 0, "total_skipped": 0, "last_processed": null }
    }
  ]
}
```

### 有效规则计算
运行时统一使用深度合并：
```
effective_rules = deep_merge(global_rule_defaults, jobs[].rule_overrides)
```
`rule_overrides` 只保存与全局不同的差异项。未配置覆盖的职位完全继承全局默认。

### 兼容与迁移
- 老缓存无新字段时自动补默认值，不影响执行
- 缓存版本 < 7.3 时自动迁移补全新字段

---

## 三、执行流程

### 阶段 0：缓存检查与模式选择

1. 检查缓存文件是否存在
2. **无缓存**：初始化 v7.3 默认结构，提示首次使用
3. **有缓存**：
   - 识别新增/变更/关闭职位
   - 若版本低于 7.3 则自动迁移
4. 提供处理选项：
   - **快速模式**（推荐）：仅解析新增职位，其他沿用缓存
   - **完整模式**：重新解析全部职位
   - **仅更新**：同步职位与规则，不执行筛选
   - **查看/编辑缓存**：手动修改全局默认或职位覆盖
   - **直接处理**：使用缓存立即执行
5. 选择流程模式：`main_only`（默认）或 `full`
6. 确认职位处理优先级

### 阶段 1：职位解析与规则同步

1. 打开 Boss直聘企业端 → 职位管理
2. 读取"开放中"职位列表，提取基础字段（名称/地点/经验/学历/薪资/浏览数/沟通数）
3. **仅对新增/变更职位**进入详情页，解析：
   - 岗位职责与任职要求
   - 必备技能与加分技能
   - 技术关键词（PyTorch、LangChain、RAG 等）
   - 业务关键词（推荐系统、NLP、CV 等）
4. 将解析结果与用户确认的偏好写入 `jobs[].rule_overrides`（只存差异项）
5. 展示职位配置总览，区分"缓存职位"和"新增职位"

**必问项（每个新增职位）**：
- 学校硬性要求？（985/QS100/211/不限）
- 公司背景要求？（硬性/优先/不限，具体公司列表）
- 专业领域经验？（Agent/RAG/LLM微调等）
- 筛选阈值？（60/70/80 分）
- 处理优先级？（高/中/低）

6. 用户确认后保存缓存

### 阶段 2：处理职位候选人

按优先级顺序处理每个职位，对每个职位执行：

#### 2.1 进入候选人页面
- 打开"推荐牛人"页面，选择当前职位
- 确认页面加载完成

#### 2.2 批量收集与筛选（每批 10-15 人）

**收集阶段**：滚动收集可见候选人的姓名、学校、公司、学历、按钮状态、在线状态。

**硬性筛选**（按优先级依次淘汰）：

| 优先级 | 筛选项 | 规则 |
|--------|--------|------|
| 1 | 已联系检查 | 按钮显示"继续沟通" → 直接跳过 |
| 2 | 学校要求 | 来自 effective_rules.school_policy |
| 3 | 学历层级 | 职位要求硕士但候选人仅本科 → 跳过 |
| 4 | 专业要求 | 非计算机相关专业 → 跳过 |
| 5 | 公司背景 | 来自 effective_rules 或职位覆盖的公司要求 |

**评分排序**（通过硬性筛选的候选人，总分 100 分）：

| 维度 | 满分 | 评分标准 |
|------|------|----------|
| 学校层级 | 30分 | QS Top50=30, C9=28, QS51-100=25, 985=22, QS101-200=18 |
| 公司匹配 | 40分 | 目标公司在职=40, 目标公司历史=35, 相关大厂=25, 其他优质=15 |
| 活跃度 | 15分 | 在线=15, 1小时内=12, 今日=10, 本周=8, 其他=5 |
| 求职意愿 | 15分 | 离职随时=15, 在职考虑=12, 月内到岗=10, 暂不考虑=5 |

按总分排序，联系 Top 3-5 候选人。

#### 2.3 执行打招呼
- 点击"打招呼"按钮 → 等待弹窗 → 发送预设消息 → 确认按钮变为"继续沟通"
- 执行幂等保护（协议5）和留痕（协议6）

#### 2.4 持续遍历直到正确终止
- 重复 2.2-2.3 批量处理
- 仅按协议3的终止信号停止当前页签
- 命中上限弹窗立即执行协议1（硬终止）
- 命中频率告警执行协议2（软退避）

#### 2.5 切换页签与职位
- `main_only` 模式：当前职位的推荐/精选/最新处理完 → 切下一个职位
- `full` 模式：主页面完成后继续处理"新牛人"等扩展页签
- 所有职位处理完毕后进入阶段3

#### 2.6 实时记录
- 每个职位处理完后更新缓存中的 stats 字段
- 静默记录遍历/筛选/操作/评分指标用于复盘

---

## 四、总结与自动复盘

### 4.1 执行报告
汇总所有职位的统计数据：
- 每个职位：联系人数、跳过人数、跳过原因分布、联系转化率
- 全局汇总：总处理职位数、总联系/跳过人数、总体转化率
- 终止原因与风控事件（上限触发、频率告警、人工中断）
- 解析质量异常批次需附"可信度下降"提示
- 与上次执行的历史对比

### 4.2 自动复盘（任务完成后主动输出）

#### 需要采集的指标
- **遍历效率**：滚动次数、候选人数量、终止原因、耗时
- **筛选效率**：通过率、已联系数量、拒绝原因分布
- **操作效率**：批次大小、失败次数、重试次数、退避次数、幂等跳过次数
- **评分分布**：90+/80-89/70-79/60-69 各档人数与平均分
- **风控事件**：每日上限触发、频率告警、人工中断
- **解析质量**：姓名/关键字段解析失败率、批次可信度状态
- **联系留痕样本**：候选人指纹、规则标签、触发摘要

#### 异常检测规则

| 异常类型 | 触发条件 | 建议方向 |
|----------|----------|----------|
| 遍历效率低 | 滚动>25次但候选人<30 | 检查网络/页面加载 |
| 通过率过低 | <5% | 放宽学校或公司要求 |
| 通过率过高 | >80% | 提高阈值或增加硬性要求 |
| 覆盖率不足 | 终止原因非"没有更多" | 检查终止逻辑 |
| 按钮识别异常 | 失败>5次 | 增加等待时间 |
| 联系失败率高 | >10% | 检查账号状态/沟通上限 |
| 高分候选人少 | 90+占比<10%且联系>10人 | 扩展目标公司列表 |
| 候选人质量低 | 联系候选人平均分<75 | 提高联系阈值 |
| 频率退避过多 | rate_limit_hits 过高 | 增大批次间隔 |
| 解析质量差 | 解析失败率>20% | 标记批次可信度下降 |
| 幂等失效 | 同一候选人重复点击比例偏高 | 检查按钮状态校验逻辑 |

#### 复盘报告输出
- 每个职位的 4 维度评分（遍历/筛选/操作/候选人质量，各 5 分制）
- 检测到的异常与优化建议（含预期效果和实施难度）
- 与历史执行的对比分析
- 下次执行行动计划（立即/短期/长期）

报告模板和数据结构见 `references/`（生成报告时 view）：
- `references/execution_metrics_template.json` — 执行指标完整结构
- `references/auto_reflection_report_template.md` — 复盘报告模板
- `references/evolution_history_template.json` — 进化历史结构

### 4.3 更新进化历史
将本次复盘结果追加到 `/home/claude/bosszhibin_cache/evolution_history.json`，下次执行时自动加载用于对比分析。

---

## 五、异常情况处理

| 异常 | 处理方式 |
|------|----------|
| 页面加载失败 | 等待 3 秒后重试，最多 3 次，失败则跳过当前操作 |
| 验证码出现 | 暂停并请用户手动处理，等待用户说"继续" |
| 每日上限弹窗 | 立即硬终止（协议1），进入总结 |
| 频率告警 | 软退避（协议2），等待后继续 |
| 按钮不可用 | 记录失败原因，继续处理后续候选人 |
| 候选人信息缺失 | 硬性要求字段缺失→跳过；优先项缺失→继续评估其他条件 |
| 账号未登录 | 暂停并提示用户登录 |

---

## 六、缓存管理命令

| 命令 | 说明 |
|------|------|
| 查看缓存 | 显示全局默认、职位覆盖、处理统计 |
| 编辑缓存 | 优先修改全局默认，必要时设置职位覆盖 |
| 清除缓存 | 删除所有缓存（需用户确认） |
| 导出缓存 | 支持 JSON/Excel/Markdown |
| 导入缓存 | 从备份恢复 |

---

## 七、重要提醒

**限制**：无法绕过平台每日沟通上限；无法自动回复候选人消息；筛选基于列表信息可能遗漏部分优质候选人；需人工最终决策。

**价值**：简历筛选效率提升 10 倍以上；标准化筛选减少人为偏差；及时触达新候选人；数据化招聘过程便于分析优化；自动复盘持续进化。
